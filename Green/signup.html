<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Signup ‚Ä¢ Krishi Sakhi</title>
  <link rel="stylesheet" href="styles.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <style>
    body { 
      background: linear-gradient(rgba(0,0,0,0.45), rgba(0,0,0,0.45)),
                  url('https://images.unsplash.com/photo-1601288496920-00197964033a?q=80&w=1600&auto=format&fit=crop');
      background-size: cover; background-position: center; background-attachment: fixed;
    }
    .card { background: rgba(255,255,255,0.96); backdrop-filter: blur(3px); box-shadow: 0 10px 30px rgba(0,0,0,.35); }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="brand">Krishi Sakhi</div>
      <nav>
        <ul class="nav">
          <li><a href="index.html"><span class="icon"><i class="fa-solid fa-house"></i></span> <span data-i18n="home">Home</span></a></li>
          <li><a class="active" href="signup.html"><span class="icon"><i class="fa-solid fa-user-plus"></i></span> <span data-i18n="signup">Signup</span></a></li>
          <li><a href="login.html"><span class="icon"><i class="fa-solid fa-right-to-bracket"></i></span> <span data-i18n="login">Login</span></a></li>
          <li><a href="profile.html"><span class="icon"><i class="fa-solid fa-user"></i></span> <span data-i18n="profile">Profile</span></a></li>
          <li><a href="farm-details.html"><span class="icon"><i class="fa-solid fa-gear"></i></span> <span data-i18n="farm">Farm Details</span></a></li>
          <li><a href="crops-yield.html"><span class="icon"><i class="fa-solid fa-seedling"></i></span> <span data-i18n="crops">Crops &amp; Yield</span></a></li>
          <li><a href="irrigation.html"><span class="icon"><i class="fa-solid fa-droplet"></i></span> <span data-i18n="irrigation">Irrigation</span></a></li>
          <li><a href="analytics.html"><span class="icon"><i class="fa-solid fa-chart-line"></i></span> <span data-i18n="analytics">Analytics</span></a></li>
          <li><a href="marketplace.html"><span class="icon"><i class="fa-solid fa-store"></i></span> <span data-i18n="market">Marketplace</span></a></li>
          <li><a href="settings.html"><span class="icon"><i class="fa-solid fa-sliders"></i></span> <span data-i18n="settings">Settings</span></a></li>
          <li><a href="weather.html"><span class="icon"><i class="fa-solid fa-cloud-sun"></i></span> <span data-i18n="weather">Weather</span></a></li>
          <li><a href="chatbot.html"><span class="icon"><i class="fa-solid fa-robot"></i></span> <span data-i18n="chat">Chatbot</span></a></li>
        </ul>
      </nav>
    </aside>
    <main class="main">
      <div class="actions" style="justify-content:space-between;align-items:center;margin-bottom:12px">
        <div class="lang-toggle">
          <button id="btn-en" class="active">English</button>
          <button id="btn-ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</button>
        </div>
        <a class="btn secondary" href="login.html"><i class="fa-solid fa-right-to-bracket"></i> <span data-i18n="goto_login">Go to Login</span></a>
      </div>

      
      <div class="card">
        <h1 class="header" data-i18n="title">Farmer Registration</h1>
        <form id="signupForm" class="row g-2">
          <div>
            <div class="label" data-i18n="name">Name</div>
            <div class="input-with-voice"><input class="input" id="name" placeholder="Name / ‡¥™‡µá‡¥∞‡µç" /><button type="button" class="voice-btn" data-target="name">üé§</button></div>
          </div>
          <div>
            <div class="label" data-i18n="age">Age</div>
            <input class="input" id="age" type="number" placeholder="Age / ‡¥µ‡¥Ø‡¥∏‡µç" />
          </div>
          <div>
            <div class="label" data-i18n="gender">Gender</div>
            <select class="select" id="gender">
              <option value="male">Male / ‡¥™‡µÅ‡¥∞‡µÅ‡¥∑‡µª</option>
              <option value="female">Female / ‡¥∏‡µç‡¥§‡µç‡¥∞‡µÄ</option>
              <option value="other">Other / ‡¥Æ‡¥±‡µç‡¥±‡µÅ‡¥≥‡µç‡¥≥‡¥µ‡µº</option>
            </select>
          </div>
          <div>
            <div class="label" data-i18n="phone">Phone</div>
            <div class="input-with-voice"><input class="input" id="phone" placeholder="Phone / ‡¥´‡µã‡µ∫" /><button type="button" class="voice-btn" data-target="phone">üé§</button></div>
          </div>
          <div>
            <div class="label" data-i18n="email">Email</div>
            <div class="input-with-voice"><input class="input" id="email" placeholder="Email / ‡¥á‡¥Æ‡µÜ‡¥Ø‡¥ø‡µΩ" /><button type="button" class="voice-btn" data-target="email">üé§</button></div>
          </div>
          <div class="g-2" style="grid-column:1/-1">
            <div>
              <div class="label" data-i18n="address">Address</div>
              <div class="input-with-voice"><input class="input" id="address" placeholder="Address / ‡¥µ‡¥ø‡¥≤‡¥æ‡¥∏‡¥Ç" /><button type="button" class="voice-btn" data-target="address">üé§</button></div>
            </div>
            <div>
              <div class="label" data-i18n="district">District</div>
              <input class="input" id="district" placeholder="District / ‡¥ú‡¥ø‡¥≤‡µç‡¥≤" />
            </div>
            <div>
              <div class="label" data-i18n="village">Village</div>
              <input class="input" id="village" placeholder="Village / ‡¥ó‡µç‡¥∞‡¥æ‡¥Æ‡¥Ç" />
            </div>
            <div>
              <div class="label" data-i18n="pincode">Pincode</div>
              <input class="input" id="pincode" placeholder="Pincode / ‡¥™‡¥ø‡¥®‡µç‚Äç‡¥ï‡µã‡¥°‡µç" />
            </div>
          </div>
          <div>
            <div class="label" data-i18n="farm_name">Farm Name</div>
            <div class="input-with-voice"><input class="input" id="farmName" placeholder="Farm Name / ‡¥ï‡µÉ‡¥∑‡¥ø‡¥Ø‡¥ø‡¥ü‡¥§‡µç‡¥§‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥™‡µá‡¥∞‡µç" /><button type="button" class="voice-btn" data-target="farmName">üé§</button></div>
          </div>
          <div>
            <div class="label" data-i18n="reg_no">Registration No</div>
            <input class="input" id="regNo" placeholder="Registration No / ‡¥∞‡¥ú‡¥ø‡¥∏‡µç‚Äå‡¥ü‡µç‡¥∞‡µá‡¥∑‡µª ‡¥®‡¥Æ‡µç‡¥™‡µº" />
          </div>
          <div>
            <div class="label" data-i18n="username">Username</div>
            <input class="input" id="username" placeholder="Username / ‡¥â‡¥™‡¥Ø‡µã‡¥ï‡µç‡¥§‡µÉ‡¥®‡¥æ‡¥Æ‡¥Ç" />
          </div>
          <div>
            <div class="label" data-i18n="password">Password</div>
            <input class="input" id="password" type="password" placeholder="Password / ‡¥™‡¥æ‡¥∏‡µç‚Äå‡¥µ‡µá‡¥°‡µç" />
          </div>
          <div style="grid-column:1/-1">
            <div class="label" data-i18n="security_q">Security Question</div>
            <input class="input" id="secQ" placeholder="Your first school? / ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥Ü‡¥¶‡µç‡¥Ø ‡¥∏‡µç‡¥ï‡µÇ‡µæ?" />
          </div>
          <div class="actions" style="grid-column:1/-1">
            <button class="btn" id="submitBtn" type="submit"><i class="fa-solid fa-floppy-disk"></i> <span data-i18n="submit">Register</span></button>
            <span class="pill" id="formStatus">Ready</span>
          </div>
        </form>
      </div>
      

    </main>
  </div>

  <script>
    // I18N
    const I18N={
      en:{home:'Home',signup:'Signup',login:'Login',goto_login:'Go to Login',title:'Farmer Registration',name:'Name',age:'Age',gender:'Gender',phone:'Phone',email:'Email',address:'Address',district:'District',village:'Village',pincode:'Pincode',farm_name:'Farm Name',reg_no:'Registration No',username:'Username',password:'Password',security_q:'Security Question',submit:'Register',required_msg:'Please fill all required fields.'},
      ml:{home:'‡¥π‡µã‡¥Ç',signup:'‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡µº',login:'‡¥≤‡µã‡¥ó‡¥ø‡µª',goto_login:'‡¥≤‡µã‡¥ó‡¥ø‡µª ‡¥™‡µá‡¥ú‡¥ø‡¥≤‡µá‡¥ï‡µç‡¥ï‡µç',title:'‡¥ï‡µº‡¥∑‡¥ï ‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥ü‡µç‡¥∞‡µá‡¥∑‡µª',name:'‡¥™‡µá‡¥∞‡µç',age:'‡¥µ‡¥Ø‡¥∏‡µç',gender:'‡¥≤‡¥ø‡¥Ç‡¥ó‡¥Ç',phone:'‡¥´‡µã‡µ∫',email:'‡¥á‡¥Æ‡µÜ‡¥Ø‡¥ø‡µΩ',address:'‡¥µ‡¥ø‡¥≤‡¥æ‡¥∏‡¥Ç',district:'‡¥ú‡¥ø‡¥≤‡µç‡¥≤',village:'‡¥ó‡µç‡¥∞‡¥æ‡¥Æ‡¥Ç',pincode:'‡¥™‡¥ø‡¥®‡µç‚Äç‡¥ï‡µã‡¥°‡µç',farm_name:'‡¥ï‡µÉ‡¥∑‡¥ø‡¥Ø‡¥ø‡¥ü‡¥§‡µç‡¥§‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥™‡µá‡¥∞‡µç',reg_no:'‡¥∞‡¥ú‡¥ø‡¥∏‡µç‚Äå‡¥ü‡µç‡¥∞‡µá‡¥∑‡µª ‡¥®‡¥Æ‡µç‡¥™‡µº',username:'‡¥â‡¥™‡¥Ø‡µã‡¥ï‡µç‡¥§‡µÉ‡¥®‡¥æ‡¥Æ‡¥Ç',password:'‡¥™‡¥æ‡¥∏‡µç‚Äå‡¥µ‡µá‡¥°‡µç',security_q:'‡¥∏‡µÜ‡¥ï‡µç‡¥Ø‡µÇ‡¥∞‡¥ø‡¥±‡µç‡¥±‡¥ø ‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥Ç',submit:'‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡µº',required_msg:'‡¥¶‡¥Ø‡¥µ‡¥æ‡¥Ø‡¥ø ‡¥Ü‡¥µ‡¥∂‡µç‡¥Ø‡¥Æ‡¥æ‡¥Ø ‡¥´‡µÄ‡µΩ‡¥°‡µÅ‡¥ï‡µæ ‡¥™‡µÇ‡¥∞‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï.'}
    };
    const btnEn=document.getElementById('btn-en'), btnMl=document.getElementById('btn-ml');
    function setLang(l){ document.querySelectorAll('[data-i18n]').forEach(el=>{const k=el.getAttribute('data-i18n'); el.textContent=I18N[l][k]||el.textContent}); btnEn.classList.toggle('active',l==='en'); btnMl.classList.toggle('active',l==='ml'); currentLang=l; }
    btnEn.addEventListener('click',()=>setLang('en')); btnMl.addEventListener('click',()=>setLang('ml'));
    let currentLang='en'; setLang('en');

    // Voice input
    function attachVoice(btn){ const Rec=window.SpeechRecognition||window.webkitSpeechRecognition; if(!Rec){btn.style.display='none';return;} const id=btn.dataset.target; const input=document.getElementById(id); const rec=new Rec(); rec.continuous=false; rec.interimResults=false; btn.addEventListener('click',()=>{ rec.lang=currentLang==='en'?'en-IN':'ml-IN'; rec.start(); btn.classList.add('listening');}); rec.onresult=e=>{ input.value=e.results[0][0].transcript; }; rec.onend=()=>btn.classList.remove('listening'); }
    document.querySelectorAll('.voice-btn').forEach(attachVoice);

    // Validation + audio confirmation
    document.getElementById('signupForm').addEventListener('submit',e=>{
      e.preventDefault();
      const ids=['name','age','phone','address','district','village','pincode','username','password'];
      for(const id of ids){ const el=document.getElementById(id); if(!el.value||el.value.trim()===''){ alert(I18N[currentLang].required_msg); el.focus(); return; } }
      // Store minimal profile locally
      const profile={name:document.getElementById('name').value, phone:document.getElementById('phone').value, farm:document.getElementById('farmName').value};
      localStorage.setItem('green:profile', JSON.stringify(profile));
      document.getElementById('formStatus').textContent='‚úì Registered';
      if('speechSynthesis' in window){ const msg=new SpeechSynthesisUtterance(currentLang==='en'?'Registration completed':'‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥ü‡µç‡¥∞‡µá‡¥∑‡µª ‡¥™‡µÇ‡µº‡¥§‡µç‡¥§‡¥ø‡¥Ø‡¥æ‡¥Ø‡¥ø'); speechSynthesis.speak(msg); }
      setTimeout(()=>{ window.location.href='login.html'; }, 800);
    });
  </script>
  
  <!-- Weather slider -->
  <button class="chatbot-toggle" id="weatherToggle" title="Weather">‚òÅÔ∏è</button>
  <div class="chatbot-panel" id="weatherPanel">
    <div class="chatbot-header">
      <strong>14-Day Weather</strong>
      <a href="weather.html" class="btn secondary" style="padding:4px 8px">Open</a>
    </div>
    <div class="chatbot-body">
      <div id="wxPreview" class="wx-list"></div>
      <div class="hint">Showing next days. Click Open for full 2-week forecast.</div>
    </div>
  </div>
  <script>
    async function loadWeatherPreview(){
      const coords = await new Promise(res=>{
        if(navigator.geolocation){ navigator.geolocation.getCurrentPosition(p=>res({lat:p.coords.latitude, lon:p.coords.longitude}), ()=>res(null), {timeout:3000}); } else res(null);
      });
      const lat = coords?.lat ?? 8.5241; // Thiruvananthapuram
      const lon = coords?.lon ?? 76.9366;
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=temperature_2m_max,temperature_2m_min,precipitation_probability_mean&forecast_days=14&timezone=auto`;
      try{
        const r = await fetch(url); const j = await r.json();
        const d = j.daily; const list=document.getElementById('wxPreview'); list.innerHTML='';
        (d.time||[]).slice(0,6).forEach((date,i)=>{
          const max=d.temperature_2m_max[i], min=d.temperature_2m_min[i], pop=(d.precipitation_probability_mean?.[i]??0);
          const div=document.createElement('div'); div.className='wx-card';
          div.innerHTML = `<div><div>${new Date(date).toLocaleDateString()}</div><div class='wx-badge'>Rain ${pop}%</div></div><div class='wx-temp'>${Math.round(min)}¬∞ / ${Math.round(max)}¬∞</div>`;
          list.appendChild(div);
        });
      }catch(e){ document.getElementById('wxPreview').innerHTML='<div class=\"hint\">Weather unavailable offline</div>'; }
    }
    const wxToggle=document.getElementById('weatherToggle'); const wxPanel=document.getElementById('weatherPanel');
    wxToggle.addEventListener('click',()=>{ wxPanel.style.display=wxPanel.style.display==='flex'?'none':'flex'; if(wxPanel.style.display==='flex') loadWeatherPreview(); });
  </script>
  
  <!-- Chatbot slider -->
  <button class="chatbot-toggle" id="chatbotToggle" title="Ask Krishi Sakhi">üí¨</button>
  <div class="chatbot-panel" id="chatbotPanel">
    <div class="chatbot-header">
      <strong>Krishi Sakhi Chat</strong>
      <button id="chatbotClose" class="btn secondary" style="padding:4px 8px">‚úï</button>
    </div>
    <div class="chatbot-body" id="chatBody">
      <div class="chat-msg"><div class="chat-bubble">Hi! Ask me about crops, irrigation, weather, or market prices. Try one:</div></div>
      <div class="suggestions" id="chatSug"></div>
    </div>
    <div class="chat-input">
      <input class="input" id="chatInput" placeholder="Type your question..." />
      <button class="btn" id="chatSend">Send</button>
    </div>
  </div>

  <script>
    const QA = [
      {q:['best crop now','season','what to plant'], a:'Current season suggestions: Virippu (Apr‚ÄìSep) paddy Uma/Jyothi; vegetables like okra and cucumber.'},
      {q:['irrigation schedule','water'], a:'Irrigation advice: maintain 2‚Äì5 cm water after transplanting; reduce before harvest.'},
      {q:['fertilizer','npk'], a:'Follow soil test. Example split: 60:30:30 kg/acre in 3 splits (crop dependent).'},
      {q:['market price','price'], a:'Market prices vary daily. Check local Krishi Bhavan bulletin or state portals.'},
      {q:['weather','rain'], a:'Plan drainage for heavy rain; mulch to conserve moisture.'}
    ];
    const SUG = ['What to plant this season?','Irrigation schedule','Fertilizer guidance','Market price info','Weather tips'];
    const chatToggle=document.getElementById('chatbotToggle');
    const chatPanel=document.getElementById('chatbotPanel');
    const chatClose=document.getElementById('chatbotClose');
    const chatBody=document.getElementById('chatBody');
    const chatInput=document.getElementById('chatInput');
    const chatSend=document.getElementById('chatSend');
    const chatSug=document.getElementById('chatSug');
    function addMsg(text, user=false){ const row=document.createElement('div'); row.className='chat-msg'+(user?' user':''); const bub=document.createElement('div'); bub.className='chat-bubble'; bub.textContent=text; row.appendChild(bub); chatBody.appendChild(row); chatBody.scrollTop=chatBody.scrollHeight; }
    function answer(q){ const t=q.toLowerCase(); const hit=QA.find(x=>x.q.some(k=>t.includes(k))); return hit?hit.a:"Sorry, I don't have that info yet. Try asking about irrigation, fertilizer, market prices, or weather."; }
    function send(){ const v=chatInput.value.trim(); if(!v) return; addMsg(v,true); addMsg(answer(v)); chatInput.value=''; }
    chatSend.addEventListener('click',send); chatInput.addEventListener('keydown',e=>{ if(e.key==='Enter') send(); });
    chatToggle.addEventListener('click',()=>{ chatPanel.style.display = chatPanel.style.display==='flex'?'none':'flex'; if(chatPanel.style.display==='flex'){ chatInput.focus(); }});
    chatClose.addEventListener('click',()=>{ chatPanel.style.display='none'; });
    SUG.forEach(s=>{ const b=document.createElement('button'); b.className='suggestion'; b.textContent=s; b.addEventListener('click',()=>{ chatInput.value=s; send(); }); chatSug.appendChild(b); });
  </script>
</body>
</html>
